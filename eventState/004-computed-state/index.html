<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>004 Computed State - EventState</title>
  <script type="importmap">
    { "imports": { "@uistate/core": "../../index.js" } }
  </script>
</head>
<body>
  <h1>Computed State</h1>

  <label>First Name: <input type="text" id="firstName" placeholder="Abraham"></label><br>
  <label>Last Name: <input type="text" id="lastName" placeholder="Lincoln"></label><br>

  <p><strong>Full Name:</strong> <span id="fullName"></span></p>
  <p><strong>Character Count:</strong> <span id="charCount">0</span></p>

  <script type="module">
    import { createEventState } from '@uistate/core';

    // Create store
    const store = createEventState({
      firstName: '',
      lastName: ''
    });

    // Computed: full name (derived from firstName + lastName)
    const updateFullName = () => {
      const first = store.get('firstName');
      const last = store.get('lastName');
      const fullName = `${first} ${last}`.trim();
      document.getElementById('fullName').textContent = fullName || '(empty)';
    };

    // Computed: character count
    const updateCharCount = () => {
      const first = store.get('firstName');
      const last = store.get('lastName');
      const total = (first + last).length;
      document.getElementById('charCount').textContent = total;
    };

    // Subscribe to any state change and recompute
    store.subscribe('*', () => {
      updateFullName();
      updateCharCount();
    });

    // Wire up inputs
    document.getElementById('firstName').oninput = (e) => {
      store.set('firstName', e.target.value);
    };

    document.getElementById('lastName').oninput = (e) => {
      store.set('lastName', e.target.value);
    };

    // Initial render
    updateFullName();
    updateCharCount();
  </script>
</body>
</html>
